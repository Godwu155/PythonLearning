# 数据可视化

**In this chapter, we will learn how to utilize Matplotlib and Plotly to make data visualization.**

[TOC]





## 绘制简单的折线统计图

###  1.创建一个图像

```python
import matplotlib.pyplot as plt

squares = [1, 4, 9, 16, 25]
fig, ax = plt.subplot()
ax.plot(squares)

plt.show()
```

`fig, ax = plt.subplot()`用于去初始化一个整体的、包含全部图像的父图像*fig*，以及一个折线统计图*ax*

------



### 2.折线图plot的参数

#### **基础数据与坐标**：

1. `x,y,z ` python可传入多组数据
2. `label`给这条线命名，使用`plt.legend()`显示图例为啥

**线条样式**：

| **参数名 (简写)**  | **说明** | **常见取值示例**                                             |
| ------------------ | -------- | ------------------------------------------------------------ |
| **color (c)**      | 颜色     | `'red'`, `'b'`, `'#FF5733'` (十六进制), `(0.1, 0.2, 0.5)` (RGB) |
| **linewidth (lw)** | 线宽     | 数字（如 `1.5`, `2.0`），默认值通常为 `1`                    |
| **linestyle (ls)** | 线型     | `'-'` (实线), `'--'` (虚线), `'-.'` (点划线), `':'` (点线)   |
| **alpha**          | 透明度   | `0` 到 `1` 之间的浮点数（`0.5` 表示半透明）                  |

**标记点样式**：

| **参数名 (简写)**         | **说明**     | **常见取值示例**                                             |
| ------------------------- | ------------ | ------------------------------------------------------------ |
| **marker**                | 形状         | `'o'` (圆), `'s'` (方), `'^'` (三角), `'*'` (星), `'x'` (叉) |
| **markersize (ms)**       | 标记大小     | 数字（如 `5`, `10`）                                         |
| **markerfacecolor (mfc)** | 标记内部颜色 | 颜色字符串                                                   |
| **markeredgecolor (mec)** | 标记边缘颜色 | 颜色字符串                                                   |
| **markeredgewidth (mew)** | 边缘宽度     | 数字                                                         |

a.设置线条粗细在初始化图表时，算是全局设置`ax.plot(source of data, linewidth)`

b.设置表头和坐标轴有两种方法

​	b1.`ax.set_title`,`ax.set_xlabel("name", fontsize=num)`

​	b2.`plot.title('name')`,`plot.xlabel('name', fontsize)`

c.设置表格刻度样式

`ax.tick_params(labelsize=num)`

------



### 3.使用内置样式

`plt.style.use()`

------



### 4.绘制散点

`plt.scatter(x, y, s=num)`传入坐标信息和点的大小

`plt.scatter(x_labels, y_label, s=num)`传入一系列x，y值，符合单射关系。

scatter()参数如下：

| **参数**     | **说明**                      | **示例**                    |
| ------------ | ----------------------------- | --------------------------- |
| **`x`, `y`** | X轴和Y轴的坐标数据            | `[1,2,3], [4,5,6]`          |
| **`s`**      | 点的大小 (Area)               | `s=50` 或 `s=my_data*10`    |
| **`c`**      | 颜色或颜色序列                | `c='green'` 或 `c=y_values` |
| **`marker`** | 点的形状                      | `'o'`, `'x'`, `'D'` (菱形)  |
| **`cmap`**   | 渐变色配置（需配合 `c` 使用） | `cmap='viridis'`            |
| **`alpha`**  | 透明度                        | `alpha=0.5`                 |
| **`label`**  | 用于图例的标签                | `label='Group A'`           |

------



### 5.定制颜色

`plt.scatter(x, y, s=num, color = 'red')`

`plt.scatter(x, y, s=num, color = (0, 0, 0))`

There are two method to show the color,one is the color itself,the another one is RGB.

`colormap`颜色映射功能：

#### ① 序列型 (Sequential)

- **特点**：颜色从浅到深，或者从一种颜色平滑过渡到另一种。
- **适用**：表达有先后顺序、大小关系的数据（如：海拔、温度、时间）。
- **常用值**：`'Blues'`, `'Reds'`, `'viridis'` (默认), `'plasma'`。

#### ② 发散型 (Diverging)

- **特点**：中间是浅色，两头是截然不同的深色。
- **适用**：表达有明显“中性点”或“零点”的数据（如：收益率的盈亏、气温相对于平均值的偏差）。
- **常用值**：`'RdBu'` (红蓝), `'seismic'`, `'coolwarm'`。

#### ③ 定性型 (Qualitative)

- **特点**：颜色之间没有逻辑上的连续性，色彩对比鲜明。
- **适用**：表达类别或标签（如：第一组、第二组、第三组）。
- **常用值**：`'Set1'`, `'tab10'`, `'Paired'`。

[相关文档](https://www.matplotlib.net/stable/tutorials/colors/colormaps.html)

------



### 6.颜色映射

``plt.scatter(x, y, s=num, c=y_values, cmap = plt.am.Blues)``

### 7.自动保存

把`plt.show()`换成`plt.savefig('filename', others)`，将图像保存再指定路径下。

> [!WARNING]
>
> `plt.show()`在展示完图像后就擦除内存中的图像，认为该程序已经完成，因此应该先保存图像再展示图像。

| **参数**          | **说明**               | **推荐用法 / 典型值**                     |
| :---------------- | ---------------------- | ----------------------------------------- |
| **`dpi`**         | 图像清晰度             | `300` (高清), `600` (印刷)                |
| **`bbox_inches`** | 控制留白               | `'tight'` (自动裁剪多余空白)              |
| **`transparent`** | 背景是否透明           | `True` (制作透明素材)                     |
| **`format`**      | 指定保存格式           | `'pdf'`, `'svg'` (矢量图，无限放大不模糊) |
| **`orientation`** | 纸张方向               | `'landscape'` (横向), `'portrait'` (纵向) |
| **`pad_inches`**  | 设置图表周围的留白距离 | 单位通常为英尺                            |



------



## 随机游走

是一个经典的数学与统计学模型，描述了一个物体在每一步都按照某种随机规则决定移动方向的过程。

### 1.**一维随机游走**

线性运动，方向对立

![image-20260119213129841](C:\Users\ROG\AppData\Roaming\Typora\typora-user-images\image-20260119213129841.png)

特性：

1. 期望，如果p=0.5，则E=0，意味着最终会回到原点；
2. 方差（扩散性），偏离原点的距离会随时间增加而增加。Var（S）=n；

2.**高维随机游走&波利亚定理**

- 一维、二维游走具有常返性，在概率上一定会回到原点。



| **领域**   | **应用场景**                                                 |
| ---------- | ------------------------------------------------------------ |
| **物理学** | **布朗运动**：微小粒子在液体或气体中的随机碰撞。             |
| **金融学** | **有效市场假说**：认为股票价格的短期变动类似于随机游走，不可预测。 |
| **生物学** | **遗传漂变**：描述群体中基因频率随时间的随机波动；或动物寻找食物的路径。 |
| **计算机** | **Google PageRank**：通过模拟“随机冲浪者”点击链接来对网页重要性排名。 |

------





## 下载数据

### 1.CSV数据相关

是一串简单的以逗号分隔的数据`USC00042319,"DEATH VALLEY NATIONAL PARK, CA US",2021-01-01,71,51,56`

在python中csv 库包含了对csv文件处理的功能

```python
from pathlib import Path
import csv
import matplotlib.pyplot as plt

path = Path('weather_data/sitka_weather_2021_simple.csv')
lines = path.read_text().splitlines()  #按行拆分

# print(lines)
reader = csv.reader(lines)  #按行读取
header_row = next(reader)  #获得标题头
print(reader)
print(header_row)

for index, column_header in enumerate(header_row):
    print(index, column_header)    #分别编号

highs = []
for row in reader:
    high = int(row[4])   #取特定的数据
    highs.append(high)

plt.style.use('seaborn-v0_8')
fig, ax = plt.subplots()
ax.plot(highs,color='red')

ax.set_xlabel(' ',fontsize=16)
ax.set_ylabel('Temperature(F)',fontsize=16)
ax.set_title("Daily High Temperatures, July 2021",fontsize=24)
ax.tick_params(axis='both', which='major', labelsize=16)

plt.show()
```

### 2.使用datetime

```python
from datetime import datetime
datetime.strptime('2021-07-01', '%Y-%m-%d')
```

按照'2021-07-01', '%Y-%m-%d'的格式对日期字符串进行读取。

datetime中的日期时间格式参数：

| 参数 |         含义         |
| :--: | :------------------: |
|  %A  |        星期几        |
|  %B  |  月份名（January）   |
|  %m  |    用数字表示月份    |
|  %d  | 用数表示月份中的一天 |
|  %Y  |     四位数的年份     |
|  %y  |     两位数的年份     |
|  %H  |   24小时制的小时数   |
|  %I  |   12小时制的小时数   |
|  %p  |       am 或 pm       |
|  %M  |        分钟数        |
|  %S  |         秒数         |

将时间显示在横坐标轴上`fig.autofmt_xdate()`

填充折线之间的部分使用`ax.fillbetween(x:[],y:[][][] []...,facecolor=,alpha=)`alpha为透明度默认值为1

### 3.制作地震散点图：GeoJSON格式

什么是JSON（JavaScript Object Notation）

​	通用的轻量级数据交换格式，由{}包裹的一系列键值对，如：

```Json
{
  "name": "张三",
  "age": 25,
  "isStudent": false,
  "skills": ["Python", "Java", "SQL"],
  "address": {
    "city": "北京",
    "zipcode": "100000"
  },
  "notes": null
}
```

> [!NOTE]
>
> **结构：** 数据由逗号分隔，大括号 `{}` 保存对象，中括号 `[]` 保存数组（列表）。
>
> **键 (Key)：** 必须是**字符串**，并且必须用**双引号** `""` 包裹（例如 `"name"`）。
>
> **值 (Value)：** 可以是以下几种数据类型：
>
> - **字符串** (String): `"Hello"`
> - **数字** (Number): `100` 或 `3.14`
> - **布尔值** (Boolean): `true` 或 `false`
> - **空值** (Null): `null`
> - **对象** (Object): 另一个 `{ ... }` 结构
> - **数组** (Array): 一个 `[ ... ]` 列表

**读取方法**

```python
path = Path('file')
contents = path.read_text(encoding='')
Json_contents = json.loads(contents)
```

读取特定信息：

`Jsoncontents[property]`

绘制散点图

```python
improt plotly.express as px

fig = px.scatter_geo(
	lat=lats,           # 对应纬度列表
    lon=lons,           # 对应经度列表
    size=mags,          # (可选) 根据震级决定点的大小
    color=mags,         # (可选) 根据震级决定点的颜色
    hover_name=titles,  # (可选) 鼠标悬停时显示地震标题
    range_color=[0, 8], # (可选) 设置颜色条的范围，比如0到8级
    title='Global Earthquakes',
    projection="natural earth", # 地图投影方式，让地图看起来更自然
    size_max= 5,

)
fig.write_html('filename')
fig.show()
```



